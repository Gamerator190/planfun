<div class="checkout-page" *ngIf="event">
  <div class="header">
    <button class="back-btn" (click)="goBack()">Â«</button>
    <div class="title">Checkout</div>
  </div>

  <div class="event-box">
    <img [src]="event.poster" class="poster" [alt]="event.title" />

    <div class="event-info">
      <h2>{{ event.title }}</h2>
      <p class="location">{{ event.location }}</p>
      <p class="line">Time: {{ time }}</p>
      <p class="line">Seat(s): {{ seatListLabel }}</p>
    </div>
  </div>

  <div class="seat-type-box">
    <h3>Seat Details</h3>

    <div class="seat-type-row" *ngFor="let sel of seatSelections">
      <div class="seat-name">{{ sel.seat }}</div>
      <div class="seat-type">{{ categoryTable[sel.typeCode]?.name || sel.typeCode }}</div>
      <div class="seat-price">Rp {{ formatRupiah(categoryTable[sel.typeCode]?.price || 0) }}</div>
    </div>
  </div>

  <div class="promo-box">
    <input
      type="text"
      [(ngModel)]="promoCodeInput"
      placeholder="Do you have a promotional code or discount coupon?"
    />
    <button (click)="applyPromo()">Apply</button>
  </div>

  <div class="price-box">
    <div class="row">
      <span>Subtotal</span>
      <span>Rp {{ formatRupiah(subtotal) }}</span>
    </div>

    @if (appliedPromo) {
    <div class="row discount">
      <span>Discount ({{appliedPromo.discountPercent}}%){{applicableCategoriesLabel}}</span>
      <span>- Rp {{ formatRupiah(discountAmount) }}</span>
    </div>
    }

    <hr />

    <div class="row total">
      <span>Total Payment</span>
      <span>Rp {{ formatRupiah(finalTotal) }}</span>
    </div>
  </div>

  <button class="pay-btn" (click)="pay()">Pay Now</button>
</div>
